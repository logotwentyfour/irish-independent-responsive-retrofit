window.com=window.com||{};window.com.inmplc=window.com.inmplc||{};window.com.inmplc.registration=window.com.inmplc.registration||{};window.com.inmplc.registration.Account=(function(){var a={};a=function(b){this.options={target:".registration-account"};$.extend(this.options,b)};a.Mode={Create:"create",Modify:"modify"};a.prototype.init=function(){var b=this;var c=registration.getUser();if(c){b.mode=a.Mode.Modify}else{b.mode=a.Mode.Create}$(b.options.target).each(function(){var K=$(this);var t,M,x=[],P=[],G={},I={},h={};var p=false;var m=false;var d=false;var N={independent:{personalDetailInfo:"What is an Independent profile?",personalDetailInfoTooltip:"Once registered an Independent profile will enable you to access all of our current services, including newsletters and any future service we may offer, by simply loggin in rather than filling out forms."},herald:{personalDetailInfo:"What is a Herald profile?",personalDetailInfoTooltip:"Once registered a Herald profile will enable you to access all of our current services, including newsletters and any future service we may offer, by simply loggin in rather than filling out forms."},belfasttelegraph:{personalDetailInfo:"What is a Belfast Telegraph profile?",personalDetailInfoTooltip:"Once registered a Belfast Telegraph profile will enable you to access all of our current services, including newsletters and any future service we may offer, by simply loggin in rather than filling out forms."}};var J={independent:[{name:"newsletters",label:"Newsletters",products:[{name:"daily_newsletter",label:"The Daily",description:"Sign up for the Independent.ie daily news roundup for free!",thumbnail:"/img/daily.png",preview:"View newsletter",previewLink:b.options.daily_newsletter},{name:"thelot_newsletter",label:"The Lot",description:"Exclusive competitions, lifestyle, fitness, fashion & entertainment via email. Sign up FOR FREE!",thumbnail:"/img/thelot.png",preview:"View newsletter",previewLink:b.options.thelot_newsletter},{name:"herald_newsletter",label:"Herald",description:"Get free news emails from herald.ie every day.",thumbnail:"/img/herald.png",preview:"View newsletter",previewLink:b.options.herald_newsletter}]}],herald:[{name:"herald_newsletters",label:"Newsletters",products:[{name:"daily_newsletter",label:"The Daily",description:"Sign up for the Independent.ie daily news roundup for free!",thumbnail:"/img/daily.png",preview:"View newsletter",previewLink:b.options.daily_newsletter},{name:"thelot_newsletter",label:"The Lot",description:"Exclusive competitions, lifestyle, fitness, fashion & entertainment via email. Sign up FOR FREE!",thumbnail:"/img/thelot.png",preview:"View newsletter",previewLink:b.options.thelot_newsletter},{name:"herald_newsletter",label:"Herald",description:"Get free news emails from herald.ie every day.",thumbnail:"/img/herald.png",preview:"View newsletter",previewLink:b.options.herald_newsletter}]}],belfasttelegraph:[{name:"bt_alerts",label:"Belfast Telegraph Alerts",products:[{name:"bt_dailynews",label:"Daily News Headlines",description:"Daily news headlines from Belfast Telegraph.",thumbnail:"/img/daily-newsletter.png",preview:"View newsletter",previewLink:b.options.bt_dailynews},{name:"bt_weeklybusiness",label:"Weekly Business Digest",description:"Weekly business digest from Belfast Telegraph.",thumbnail:"/img/business-newsletter.png",preview:"View newsletter",previewLink:b.options.bt_weeklybusiness}]}]};var O={independent:[[{list:[{name:"pref_entertainment",label:"Entertainment",list:[{name:"pref_news_gossip",label:"News & Gossip"},{name:"pref_film_cinema",label:"Film & Cinema"},{name:"pref_music",label:"Music"},{name:"pref_going_out",label:"Going Out"},{name:"pref_books",label:"Books"}]},{name:"pref_education",label:"Education"},{name:"pref_business",label:"Business"}]}],[{list:[{name:"pref_sports",label:"Sports",list:[{name:"pref_soccer",label:"Soccer"},{name:"pref_gaa",label:"GAA"},{name:"pref_rugby",label:"Rugby"},{name:"pref_golf",label:"Golf"},{name:"pref_horse_racing",label:"Horse Racing"},{name:"pref_motor_sports",label:"Motor Sports"},{name:"pref_other_sports",label:"Other Sports"}]}]}],[{list:[{name:"pref_motoring",label:"Motoring"},{name:"pref_property",label:"Property"},{name:"pref_careers",label:"Careers"},{name:"pref_technology",label:"Technology"},{name:"pref_travel",label:"Travel"}]}]],herald:[[{list:[{name:"pref_entertainment",label:"Entertainment",list:[{name:"pref_news_gossip",label:"News & Gossip"},{name:"pref_film_cinema",label:"Film & Cinema"},{name:"pref_music",label:"Music"},{name:"pref_going_out",label:"Going Out"},{name:"pref_books",label:"Books"}]},{name:"pref_education",label:"Education"},{name:"pref_business",label:"Business"}]}],[{list:[{name:"pref_sports",label:"Sports",list:[{name:"pref_soccer",label:"Soccer"},{name:"pref_gaa",label:"GAA"},{name:"pref_rugby",label:"Rugby"},{name:"pref_golf",label:"Golf"},{name:"pref_horse_racing",label:"Horse Racing"},{name:"pref_motor_sports",label:"Motor Sports"},{name:"pref_other_sports",label:"Other Sports"}]}]}],[{list:[{name:"pref_motoring",label:"Motoring"},{name:"pref_property",label:"Property"},{name:"pref_careers",label:"Careers"},{name:"pref_technology",label:"Technology"},{name:"pref_travel",label:"Travel"}]}]],belfasttelegraph:[[{list:[{name:"pref_news",label:"News",list:[{name:"pref_news_northern_ireland",label:"Northern Ireland"},{name:"pref_news_uk",label:"UK"},{name:"pref_news_international",label:"International"}]},{name:"pref_careers",label:"Careers"},{name:"pref_technology",label:"Technology"},{name:"pref_travel",label:"Travel"},{name:"pref_education",label:"Education"},{name:"pref_business",label:"Business"},{name:"pref_sports",label:"Sports",list:[{name:"pref_soccer",label:"Soccer"},{name:"pref_gaa",label:"GAA"},{name:"pref_rugby",label:"Rugby"},{name:"pref_golf",label:"Golf"},{name:"pref_horse_racing",label:"Horse Racing"},{name:"pref_motor_sports",label:"Motor Sports"},{name:"pref_other_sports",label:"Other Sports"}]}]}],[{list:[{name:"pref_entertainment",label:"Entertainment",list:[{name:"pref_news_gossip",label:"News & Gossip"},{name:"pref_film_cinema",label:"Film & Cinema"},{name:"pref_music",label:"Music"},{name:"pref_going_out",label:"Going Out"},{name:"pref_books",label:"Books"}]},{name:"pref_motoring",label:"Motoring"},{name:"pref_property",label:"Property"}]},{caption:"How do you read the Belfast Telegraph"},{list:[{name:"pref_bthow_printed_paper",label:"Printed Paper"},{name:"pref_bthow_website",label:"Website"},{name:"pref_bthow_epaper",label:"ePaper"},{name:"pref_bthow_iphone",label:"iPhone"},{name:"pref_bthow_ipad",label:"iPad"},{name:"pref_bthow_mobile",label:"Mobile"}]}],[{caption:"Where do you read the Belfast Telegraph"},{list:[{name:"pref_btwhere_home",label:"At home"},{name:"pref_btwhere_work",label:"At work"},{name:"pref_btwhere_move",label:"On the move"}]},{caption:"When do you read the Belfast Telegraph"},{list:[{name:"pref_btwhen_morning",label:"Morning"},{name:"pref_btwhen_evening",label:"Evening"},{name:"pref_btwhen_afternoon",label:"Afternoon"},{name:"pref_btwhen_all_day",label:"All Day"}]}]]};var Q=function(){if($.parameter("reg")=="validate"){q();z();f();S();l()}else{if($.parameter("reg")=="unsubscribe"){q();z();f();S();j()}else{if(b.mode==a.Mode.Create){if(registration.isLoggedIn()){location.href=registration.getOption("accountURL")}else{q();R();f();S();w()}}else{if(b.mode==a.Mode.Modify){if(!registration.isLoggedIn()){location.href=registration.getOption("registerURL")}else{z();r(function(){R();f();S();if(location.hash&&(location.hash=="#newsletters")){v()}else{w()}})}}}}}};var q=function(){registration.onLoggedIn(function(){if(!m){location.href=registration.getOption("accountURL")}})};var z=function(){registration.onLoggedOut(function(){if(!d){location.href=registration.getOption("registerURL")}})};var r=function(T){if(registration.getUser()){registration.getAuthentications(function(U){if(U.exception){B('Server responded with error: "'+U.exception+'". Could not load current profile. Please try again later.')}else{x=U.authentications||[];$.each(x,function(V,W){if(W.type==com.inmplc.registration.API.AuthUsername){h.profile=W.key}else{if(W.type==com.inmplc.registration.API.AuthEmail){h.email=W.key}else{if(W.type==com.inmplc.registration.API.AuthFacebook){p=true}}}})}});registration.getSubscriptions(function(U){if(U.exception){B('Server responded with error: "'+U.exception+'". Could not load current profile. Please try again later.')}else{P=U.subscriptions||[];$.each(P,function(V,W){h["prod_"+W.code]="signup"});registration.getUserProperties(function(W){G=W.userProperties||{};for(var V in G){h["prop_"+V.toLowerCase()]=W.userProperties[V].value||""}I=$.extend({},h);T&&T.call(b)})}})}else{T&&T.call(b)}};var R=function(){if(!M){M=[{name:"personalDetails",label:"Personal Details",form:w},{name:"newsletters",label:"Newsletters",form:v},{name:"interests",label:"Interests",form:g},{name:"updates",label:"Updates",form:k}]}if(!t){t=$('<nav class="nav-a"></nav>').prependTo(K.closest("section"))}};var F=function(W){var U=-1;var V=false;if((W=="remove")||(W=="thanks")){V=true}$.each(M,function(X,Y){if(Y.name==W){U=X;if(Y.denyStepback){V=true}}});var T="";if(b.mode==a.Mode.Create){T+="<h1>Register</h1><ol>"}else{T+='<h1>My Account</h1><ol class="regular">'}$.each(M,function(X,Z){var Y=[];if(X==U){Y.push("active")}if(V||((b.mode==a.Mode.Create)&&(X>U))){Y.push("nolink")}T+="<li";if(Y.length>0){T+=' class="'+Y.join(" ")+'"'}T+='><a href="#" ref="'+Z.name+'">'+Z.label+"</a></li>"});T+="</ol>";if(b.mode==a.Mode.Modify){if((W!="remove")&&(W!="thanks")){T+='<p><a href="#" ref="delete">Remove My Account</a></p>'}}t.html(T);if($.browser.msie&&parseInt($.browser.version,10)<8){t("ol li a").append('<i class="after"></i>')}t.find("li a").click(function(Y){Y.preventDefault();var X=$(this);if(!X.closest("li").hasClass("active")&&!X.closest("li").hasClass("nolink")){if(X.attr("ref")=="personalDetails"){w()}else{if(X.attr("ref")=="newsletters"){v()}else{if(X.attr("ref")=="interests"){g()}else{if(X.attr("ref")=="updates"){k()}}}}}});t.find("p a").click(function(X){X.preventDefault();e()})};var f=function(){K.addClass("wrap-a")};var w=function(){F("personalDetails");var U=N[b.options.publication];var V='<div class="fields-a"><h2>Personal Details</h2><p class="side"><a href="./" class="tooltip-a" title="'+U.personalDetailInfoTooltip+'"><span class="help-a">Rollover for Help</span> '+U.personalDetailInfo+'</a></p><div class="fieldset"><h3>Login</h3>';if(b.mode==a.Mode.Create){V+='<p><label for="register-profile" data-label="Profile Name">Profile Name <em>*</em></label> <input type="text" id="register-profile" name="profile" value="'+s("profile")+'" maxlength="15" /></p><p><label for="register-email" data-label="Email Address">Email Address <em>*</em></label> <input type="text" id="register-email" name="email" value="'+s("email")+'" maxlength="254" /></p><p><label for="register-password" data-label="Password">Password <em>*</em></label> <input type="password" id="register-password" name="password" value="'+s("password")+'" maxlength="15" /></p><p><label for="register-confirm" data-label="Confirm Password">Confirm Password <em>*</em></label> <input type="password" id="register-confirm" name="confirm" value="'+s("confirm")+'" maxlength="15" /></p>'}else{if(p){V+='<p><label for="readonly-email"><span class="help-a" title="Email address is bound to your Facebook account.">Rollover for Help</span> Email Address</label> <span id="readonly-email" class="readonly">'+s("prop_email_address")+"</span></p>"}else{V+='<p><label for="register-profile" data-label="Profile Name">Profile Name <em>*</em></label> <input type="text" id="register-profile" name="profile" value="'+s("profile")+'" maxlength"15" /></p><p><label for="register-email" data-label="Email Address">Email Address <em>*</em></label> <input type="text" id="register-email" name="email" value="'+s("email")+'" maxlength="254" /></p><p><label for="register-new-password" data-label="New Password">New Password <em>*</em></label> <input type="password" id="register-new-password" name="password" value="'+s("password")+'" maxlength="15" /></p><p><label for="register-new-confirm" data-label="Confirm New Password">Confirm New Password <em>*</em></label> <input type="password" id="register-new-confirm" name="confirm" value="'+s("confirm")+'" maxlength="15" /></p>'}}V+='</div><div class="fieldset"><h3>Your Contact Information</h3><p><label for="register-first-name" data-label="First Name">First Name <em>*</em></label> <input type="text" id="register-first-name" name="prop_firstname" value="" maxlength="80" /></p><p><label for="register-surname" data-label="Surname">Surname <em>*</em></label> <input type="text" id="register-surname" name="prop_lastname" value="" maxlength="80" /></p><p><label for="register-gender" data-label="Gender">Gender <em>*</em></label> <span class="select-a small"><select id="register-gender" name="prop_gender"><option value=""></option><option value="male">Male</option><option value="female">Female</option></select></span></p><p><label for="register-country" data-label="Country">Country <em>*</em></label> <span class="select-a"><select id="register-country" name="prop_country"><option value=""></option></select></span></p><p class="hide"><label for="register-county" data-label="County">County <em>*</em></label> <span class="select-a"><select id="register-county" name="prop_county"><option value=""></option></select></span></p><p><label for="register-address1" data-label="Address Line 1">Address Line 1</label> <input type="text" id="register-address1" name="prop_address_line1" value="" maxlength="80" /></p><p><label for="register-address2" data-label="Address Line 2">Address Line 2</label> <input type="text" id="register-address2" name="prop_address_line2" value="" maxlength="80" /></p><p><label for="register-postcode" data-label="Postcode">Postcode</label> <input type="text" id="register-postcode" name="prop_postcode" value="" maxlength="15" /></p><p><label for="register-mobile" data-label="Mobile">Mobile</label> <input type="text" id="register-mobile" name="prop_mobile" value="" maxlength="15" /></p><p><label for="register-yob" data-label="Year of Birth">Year of Birth</label> <input type="text" id="register-yob" maxlength="4" name="prop_year_of_birth" value="" /></p></div><p class="action"><button type="submit" class="button-a"><span>Continue</span></button></p></div>';K.empty().append(V);var T=com.inmplc.registration.Location.getCountries(["Ireland","Northern Ireland","United Kingdom"]);$.each(T,function(aa,ab){K.find("#register-country").append('<option value="'+ab+'">'+ab+"</option>")});var W=function(){var ab=K.find("#register-county");var aa=K.find("#register-country option:selected").val();var ac=com.inmplc.registration.Location.getCounties(aa);if(ac){ab.empty();ab.append('<option value=""></option>');$.each(ac,function(ad,ae){ab.append('<option value="'+ae+'">'+ae+"</option>")});ab.closest("p").removeClass("hide")}else{ab.empty();ab.append('<option value=""></option>');ab.closest("p").addClass("hide")}};var Z=function(){var aa=K.find("#register-postcode");var ab=K.find("#register-country option:selected").val();if(ab=="Ireland"){aa.closest("p").addClass("hide");aa.val("")}else{aa.closest("p").removeClass("hide")}};K.find("#register-country").change(function(){W();Z()});i(K.find(".fieldset input, .fieldset select"));W();i(K.find("#register-county, #register-postcode"));C();var Y=function(ab,ac,ad){E(ab);if(ab.val()!=""){if(ac.validate&&ac.validate.regex&&!ac.validate.regex.test(ab.val())){y(ab,true,ac.validate.message||"")}else{if(ac.validate&&ac.validate.isNumeric&&!/^\d{1,}$/.test(ab.val())){y(ab,true,ac.validate.message||"")}else{if(ac.validate&&ac.validate.range&&((parseInt(ab.val(),10)<ac.validate.range.from)||(parseInt(ab.val(),10)>ac.validate.range.to))){y(ab,true,ac.validate.message||"")}else{if(ac.match&&ac.match.field&&(ab.val()!=ac.match.field.val())){y(ab,true,ac.match.message||"")}else{if(ac.auth&&(ac.auth.type=="username")){if(registration.isLoggedIn()){var aa={};aa[com.inmplc.registration.API.AuthUsername]=ab.val();registration.setAuthentications(aa,true,function(ae){if(ae.exception){y(ab,true,"Cannot check username. Please try again later.")}else{if(!ae.success){y(ab,true,ac.auth.message||"")}else{y(ab,false)}}ad&&ad.call(ab)})}else{registration.register([{authenticationType:com.inmplc.registration.API.AuthUsername,authenticationKey:ab.val()}],{password:"abc456d8"},true,function(ae){if(ae.exception){y(ab,true,"Cannot check username. Please try again later.")}else{if(ae.existingAuthentications){y(ab,true,ac.auth.message||"")}else{y(ab,false)}}ad&&ad.call(ab)})}}else{if(ac.auth&&(ac.auth.type=="email")){if(registration.isLoggedIn()){var aa={};aa[com.inmplc.registration.API.AuthEmail]=ab.val();registration.setAuthentications(aa,true,function(ae){if(ae.exception){y(ab,true,"Cannot check email. Please try again later.")}else{if(!ae.success){y(ab,true,ac.auth.message||"")}else{y(ab,false)}}ad&&ad.call(ab)})}else{registration.register([{authenticationType:com.inmplc.registration.API.AuthEmail,authenticationKey:ab.val()}],{password:"abc456d8"},true,function(ae){if(ae.exception){y(ab,true,"Cannot check email. Please try again later.")}else{if(ae.existingAuthentications){y(ab,true,ac.auth.message||"")}else{y(ab,false)}}ad&&ad.call(ab)})}}else{y(ab,false)}}}}}}}else{if(ac.checkEmpty){y(ab,true,ac.checkEmpty.message||(ab.closest("p").find("label").attr("data-label")+" is required."));ac.auth&&ad&&ad.call(ab)}}!ac.auth&&ad&&ad.call(ab)};var X=function(ab,aa,ac){if(ab.is("#register-profile")){Y(ab,{validate:{regex:/^(?!.*[_]{2,})(?!.*[\-]{2,})[A-Za-z0-9_-]{5,15}$/,message:"Invalid profile name. Use at least 5 characters, but no more than 15. All alphanumeric, underscore and dash characters are allowed."},auth:{type:"username",message:"Profile name already exists."},checkEmpty:aa&&{}},ac)}else{if(ab.is("#register-email")){Y(ab,{validate:{regex:/^([0-9a-zA-Z]([-.\w]*[\w])?@([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})$/,message:"Invalid email address."},auth:{type:"email",message:"Email address already exists."},checkEmpty:aa&&{}},ac)}else{if(ab.is("#register-password, #register-new-password")){Y(ab,{validate:{regex:/^(?=.*[\d@#$%^&+=!\-])[a-zA-Z\d@#$%^&+=!\-]{7,}$/,message:"Password must be minimum 7 characters with at least one number or special character (@, #, $, %, ^, &amp;, +, =, ! or -)."},checkEmpty:ab.is("#register-password")&&aa&&{}},ac)}else{if(ab.is("#register-confirm")){Y(ab,{match:{field:K.find("#register-password"),message:"Passwords do not match"},checkEmpty:ab.is("#register-confirm")&&aa&&{message:"You need to confirm your password."}},ac)}else{if(ab.is("#register-new-confirm")){Y(ab,{match:{field:K.find("#register-new-password"),message:"Passwords do not match"},checkEmpty:(K.find("#register-new-password").val()!="")&&aa&&{message:"You need to confirm your password."}},ac)}else{if(ab.is("#register-first-name, #register-surname")){Y(ab,{validate:{regex:/^(?=[-\s\.'0-9A-Za-zÁÀÂÄǍĂĀÃÅǺĄÆǼǢƁĆĊĈČÇĎḌĐƊÐÉÈĖÊËĚĔĒĘẸƎƏƐĠĜǦĞĢƔáàâäǎăāãåǻąæǽǣɓćċĉčçďḍđɗðéèėêëěĕēęẹǝəɛġĝǧğģɣĤḤĦIÍÌİÎÏǏĬĪĨĮỊĲĴĶƘĹĻŁĽĿʼNŃN̈ŇÑŅŊÓÒÔÖǑŎŌÕŐỌØǾƠŒĥḥħıíìiîïǐĭīĩįịĳĵķƙĸĺļłľŀŉńn̈ňñņŋóòôöǒŏōõőọøǿơœŔŘŖŚŜŠŞȘṢẞŤŢṬŦÞÚÙÛÜǓŬŪŨŰŮŲỤƯẂẀŴẄǷÝỲŶŸȲỸƳŹŻŽẒŕřŗſśŝšşșṣßťţṭŧþúùûüǔŭūũűůųụưẃẁŵẅƿýỳŷÿȳỹƴźżžẓ]*$)(?=[^-\s\.0-9'])(?!.*\s{2,})(?!.*\-{2,})(?!.*\.{2,})(?!.*'{2,}).{1,79}[^-\s\.0-9'][\.]?$/,message:"Invalid name. Use at least 2 characters, but no more than 80. All alphanumeric, dash and apostrophe characters are allowed."},checkEmpty:aa&&{}},ac)}else{if(ab.is("#register-gender, #register-country")){Y(ab,{checkEmpty:aa&&{}},ac)}else{if(ab.is("#register-county")){Y(ab,{checkEmpty:!ab.closest("p").is(".hide")&&aa&&{}},ac)}else{if(ab.is("#register-address1, #register-address2")){Y(ab,{validate:{regex:/^(?=[-\s\.'\/,0-9A-Za-zÁÀÂÄǍĂĀÃÅǺĄÆǼǢƁĆĊĈČÇĎḌĐƊÐÉÈĖÊËĚĔĒĘẸƎƏƐĠĜǦĞĢƔáàâäǎăāãåǻąæǽǣɓćċĉčçďḍđɗðéèėêëěĕēęẹǝəɛġĝǧğģɣĤḤĦIÍÌİÎÏǏĬĪĨĮỊĲĴĶƘĹĻŁĽĿʼNŃN̈ŇÑŅŊÓÒÔÖǑŎŌÕŐỌØǾƠŒĥḥħıíìiîïǐĭīĩįịĳĵķƙĸĺļłľŀŉńn̈ňñņŋóòôöǒŏōõőọøǿơœŔŘŖŚŜŠŞȘṢẞŤŢṬŦÞÚÙÛÜǓŬŪŨŰŮŲỤƯẂẀŴẄǷÝỲŶŸȲỸƳŹŻŽẒŕřŗſśŝšşșṣßťţṭŧþúùûüǔŭūũűůųụưẃẁŵẅƿýỳŷÿȳỹƴźżžẓ]*$)(?=[^-\s\./,])(?!.*\s{2,})(?!.*\-{2,})(?!.*\.{2,})(?!.*'{2,})(?!.*\/{2,})(?!.*,{2,}).{0,79}[^-\s\.']$/,message:"Invalid address. Use at least 1 character, but no more than 80. All alphanumeric, dash and apostrophe characters are allowed."}},ac)}else{if(ab.is("#register-postcode")){Y(ab,{validate:{regex:/^(?=[A-Za-z0-9])(?!.*\s{2,})[A-Za-z0-9\s]{2,9}[A-Za-z0-9]$/,message:"Invalid postcode."}},ac)}else{if(ab.is("#register-mobile")){Y(ab,{validate:{regex:/^[+]?[0-9]{10,}$/,message:"Invalid mobile number."}},ac)}else{if(ab.is("#register-yob")){Y(ab,{validate:{isNumeric:true,range:{from:new Date().getFullYear()-120,to:new Date().getFullYear()},message:"Invalid year of birth."}},ac)}}}}}}}}}}}}};K.find(".fieldset p input, .fieldset p select").livevalidate(function(){X($(this),false)},function(){E($(this))});K.find("p.action button").click(function(ab){ab.preventDefault();var aa=[];K.find(".fieldset p input, .fieldset p select").each(function(){aa.push($(this).attr("name"))});A();K.find(".fieldset p input, .fieldset p select").each(function(){X($(this),true,function(){var ad=$(this);var ae=ad.attr("name");($.inArray(ae,aa)>=0)&&aa.splice($.inArray(ae,aa),1);if(aa.length==0){L();var ac=(K.find(".fieldset p.error").length>0);if(!ac){n(K.find(".fieldset input, .fieldset select"));v()}}})})})};var v=function(){F("newsletters");var T=J[b.options.publication];var U="";$.each(T,function(V,W){U+="<h1>"+W.label+'</h1><ul class="list-b">';$.each(W.products,function(X,Y){U+='<li><input type="checkbox" name="prod_'+Y.name+'" id="register-'+Y.name+'" value="signup" /> <label for="register-'+Y.name+'"><img src="'+Y.thumbnail+'" width="175" height="175" alt="'+Y.label+'" /> <br /><span><strong>'+Y.label+"</strong>";if(Y.preview&&Y.previewLink){U+=' <br /><a href="'+Y.previewLink+'" target="_blank">'+Y.preview+"</a>"}U+="</span><br />";if(Y.description){U+=Y.description}U+="</label></li>"});U+="</ul>"});U+='<ul class="action-a"><li class="left"><a href="./" class="button-a back"><span>Back</span></a></li><li class="right"><a href="./" class="button-a"><span>Continue</span></a></li></ul>';K.empty().append(U);i(K.find(".list-b input"));C();K.find("ul.action-a .left .button-a").click(function(V){V.preventDefault();w()});K.find("ul.action-a .right .button-a").click(function(V){V.preventDefault();n(K.find(".list-b input"));g()})};var g=function(){F("interests");var T=O[b.options.publication];var U='<h1 class="a">Interests</h1><div class="interests-a">';$.each(T,function(V,W){U+='<div class="column">';$.each(W,function(X,Y){if(Y.caption){U+="<h3>"+Y.caption+"</h3>"}else{if(Y.list){U+="<ul>";$.each(Y.list,function(Z,aa){U+='<li><input type="checkbox" name="prop_'+aa.name+'" id="register-interest-'+aa.name+'" value="true" /> <label for="register-interest-'+aa.name+'">'+aa.label+"</label>";if(aa.list){U+="<ul>";$.each(aa.list,function(ac,ab){U+='<li><input type="checkbox" name="prop_'+ab.name+'" id="register-interest-'+ab.name+'" value="true" /> <label for="register-interest-'+ab.name+'">'+ab.label+"</label></li>"});U+="</ul>"}U+="</li>"});U+="</ul>"}}});U+="</div>"});U+='</div><ul class="action-a"><li class="left"><a href="./" class="button-a back"><span>Back</span></a></li><li class="right"><a href="./" class="button-a"><span>Continue</span></a></li></ul>';K.empty().append(U);i(K.find(".interests-a input"));C();K.find("ul.action-a .left .button-a").click(function(V){V.preventDefault();v()});K.find("ul.action-a .right .button-a").click(function(V){V.preventDefault();n(K.find(".interests-a input"));k()})};var k=function(){F("updates");var V='<p class="tick-a"><input type="checkbox" name="prop_receiveupdates" id="registration-updates" value="true" /> <label for="registration-updates"><strong>Updates</strong> <br />I would like to receive communications about features and services from Independent Newspapers and on behalf of our selected advertisers.</label></p>';if(b.mode==a.Mode.Create){V+='<p class="tick-a"><input type="checkbox" name="terms" id="registration-terms" value="agree" /> <label for="registration-terms"><strong>Terms and Conditions</strong> <br />I have read and agree to the <a href="'+b.options.termsConditionsUrl+'" target="_blank">Terms &amp; Conditions</a> and <a href="'+b.options.privacyPolicyUrl+'" target="_blank">Privacy &amp; Cookie Policy</a></label></p>'}V+='<ul class="action-a"><li class="left"><a href="./" class="button-a back"><span>Back</span></a></li>';if(b.mode==a.Mode.Create){V+='<li class="right"><a href="./" class="button-a">Complete Registration</a></li>'}else{V+='<li class="right"><a href="./" class="button-a">Update Account</a></li>'}V+="</ul>";K.empty().append(V);i(K.find("#registration-updates"));C();var W=function(X){X.closest("p").find("> strong").remove()};var T=function(X,Y){X.closest("p").append("<strong>"+Y+"</strong>")};var U=function(Y,X){W(Y);if(!Y.filter(":checked").val()){T(Y,"You must agree to the Terms & Conditions")}else{X&&X.call(Y)}};K.find(".tick-a input").click(function(){W($(this))});K.find("ul.action-a .left .button-a").click(function(X){X.preventDefault();g()});K.find("ul.action-a .right .button-a").click(function(X){X.preventDefault();if(b.mode==a.Mode.Create){U(K.find(".tick-a input#registration-terms"),function(){n(K.find(".tick-a input"));A();o()})}else{n(K.find(".tick-a input"));A();H()}})};var o=function(){var U=[];U.push({authenticationType:com.inmplc.registration.API.AuthUsername,authenticationKey:h.profile});U.push({authenticationType:com.inmplc.registration.API.AuthEmail,authenticationKey:h.email});var T=h.password;m=true;registration.register(U,{password:T},function(V){m=false;if(V.exception){L();B('Server responded with error: "'+V.exception+'". Please try again later.')}else{if(V.userRegistered){var W={};var X=[];$.each(h,function(ab,Z){if(ab.substr(0,5)=="prop_"){var aa=ab.substr(5).toLowerCase();if(Z){W[aa]=Z}}else{if(ab.substr(0,5)=="prod_"){var Y=ab.substr(5).toLowerCase();if(Z){X.push(Y)}}}});registration.setUserProperties(W,function(Y){if(Y.exception){L();B('Server responded with error: "'+Y.exception+'". Please try again later.')}else{if(Y.success){if(X.length>0){registration.subscribe(X,function(Z){if(Z.exception){L();B('Server responded with error: "'+Z.exception+'". Please try again later.')}else{if(Z.success){L();D()}else{L();B("Could not subscribe to newsletters. Please try again later.")}}})}else{L();D()}}else{L();B("Could not set user properties. Please try again later.")}}})}else{L();B("Could not register new user. Please try again later.")}}})};var H=function(){var V=[];var W=function(aa){var Z={};if(I.profile!=h.profile){Z[com.inmplc.registration.API.AuthUsername]=h.profile}if(I.email!=h.email){Z[com.inmplc.registration.API.AuthEmail]=h.email}if(!$.isEmptyObject(Z)){registration.setAuthentications(Z,function(ab){if(ab.exception){L();B('Server responded with error: "'+ab.exception+'". Please try again later.')}else{if(ab.success){if(I.profile!=h.profile){V.push("Your profile name has been updated.")}if(I.email!=h.email){V.push('Your email address was updated to "'+h.email+'". You have been sent an email to confirm your email address.')}aa&&aa.call(b)}else{if(I.profile!=h.profile){V.push("Failed to update your profile name. Please try again later.")}if(I.email!=h.email){V.push("Failed to update your email address. Please try again later.")}aa&&aa.call(b)}}})}else{aa&&aa.call(b)}};var Y=function(Z){if(h.password&&(h.password!="")){registration.setPassword(h.password,function(aa){if(aa.exception){L();B('Server responded with error: "'+aa.exception+'". Please try again later.')}else{if(aa.success){V.push("Your password has been updated.");Z&&Z.call(b)}else{V.push("Failed to update your password. Please try again later.");Z&&Z.call(b)}}})}else{Z&&Z.call(b)}};var X=function(ab){var aa=[];var Z=[];$.each(P,function(ac,ad){if(h["prod_"+ad.code]!="signup"){aa.push(ad.subscriptionNumber);if(ad.code=="daily_newsletter"){Z.push("The Daily")}else{if(ad.code=="thelot_newsletter"){Z.push("The Lot")}else{if(ad.code=="herald_newsletter"){Z.push("Herald")}else{if(ad.code=="exclusive_in_print"){Z.push("Exclusive in Print")}}}}}});if(aa.length){registration.unsubscribe(aa,function(ac){if(ac.exception){L();B('Server responded with error: "'+ac.exception+'". Please try again later.')}else{if(ac.success){$.each(Z,function(ae,ad){V.push('You have been unsubscribed from "'+ad+'".')});ab&&ab.call(b)}else{$.each(Z,function(ae,ad){V.push('Failed to unsubscribe you from "'+ad+'". Please try again later.')});ab&&ab.call(b)}}})}else{ab&&ab.call(b)}};var T=function(ab){var aa=[];var Z=[];$.each(h,function(ae,ad){if(ae.substr(0,5)=="prod_"){if(ad&&(I[ae]!=ad)){var ac=ae.substr(5).toLowerCase();aa.push(ac);if(ac=="daily_newsletter"){Z.push("The Daily")}else{if(ac=="thelot_newsletter"){Z.push("The Lot")}else{if(ac=="herald_newsletter"){Z.push("Herald")}else{if(ac=="exclusive_in_print"){Z.push("Exclusive in Print")}}}}}}});if(aa.length){registration.subscribe(aa,function(ac){if(ac.exception){L();B('Server responded with error: "'+ac.exception+'". Please try again later.')}else{if(ac.success){$.each(Z,function(ae,ad){V.push('You have been subscribed to "'+ad+'".')});ab&&ab.call(b)}else{$.each(Z,function(ae,ad){V.push('Failed to subscribe you to "'+ad+'". Please try again later.')});ab&&ab.call(b)}}})}else{ab&&ab.call(b)}};var U=function(aa){var Z={};$.each(h,function(ad,ab){if(ad.substr(0,5)=="prop_"){if(I[ad]!=ab&&(!(!I[ad]&&ab==""))){var ac=ad.substr(5).toLowerCase();Z[ac]=ab}}});if(!$.isEmptyObject(Z)){registration.setUserProperties(Z,function(ab){if(ab.exception){L();B('Server responded with error: "'+ab.exception+'". Please try again later.')}else{if(ab.success){V.push("Your preferences have been updated.");aa&&aa.call(b)}else{V.push("Failed to update your preferences. Please try again later.");aa&&aa.call(b)}}})}else{aa&&aa.call(b)}};W(function(){Y(function(){X(function(){T(function(){U(function(){if(V.length==0){V.push("There were no changes to your profile.")}L();u(V)})})})})})};var D=function(){F("thanks");var U={};$.each(h,function(Z,Y){if((Z.substr(0,5)=="prod_")&&Y){U[Z]=Y}});var V='<div class="page-a"><h1>Thank you for registering</h1><p>We have sent you an email to confirm your email address. If you have registered for newsletters you will start receiving them once you\'ve confirmed your email address.</p><p><a href="'+b.options.privacyPolicyUrl+'" target="_blank">Privacy and Cookie Policy</a></p>';if(!$.isEmptyObject(U)){var T=J[b.options.publication];$.each(T,function(Y,aa){var Z=false;$.each(aa.products,function(ab,ac){if(U["prod_"+ac.name]){Z=true}});if(Z){V+="<h2>You subscribed to the following "+aa.label+'</h2><ul class="list-a">';$.each(aa.products,function(ab,ac){if(U["prod_"+ac.name]){V+='<li><img src="'+ac.thumbnail+'" width="120" height="120" alt="'+ac.label+'" />'+ac.label+"</li>"}});V+="</ul>"}})}if(window.stButtons){V+='<h2>Tell your friends to join the conversation</h2><p><div class="w49 clean"><div class="share buttons"><span class="st_facebook_hcount" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" displayText="Facebook Recommend"></span><span class="st_twitter_hcount" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" st_via="" displayText="Tweet"></span><span class="st_googleplus_hcount" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" displayText="Google +1"></span><span class="st_sharethis" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" displayText="Share"></span></div></div></p>'}V+='<ul class="action-a">';if(document.referrer){var X;var W=location.protocol+"//"+location.host+"/";if(document.referrer.substr(document.referrer.length-1)=="/"){if(document.referrer!=W){X="Section"}}else{if((document.referrer.length>W.length)&&(document.referrer.substr(0,W.length)==W)){X="Article"}}if(X){V+='<li class="left"><a href="'+document.referrer+'" class="button-a back"><span>Back to '+X+"</span></a></li>"}}V+='<li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';K.empty().append(V);window.stButtons&&window.stButtons.locateElements();C()};var u=function(U){F("thanks");var T='<div class="page-a"><h1>Profile Updates</h1>';T+="<ul>";$.each(U,function(X,Y){T+="<li>"+Y+"</li>"});T+="</ul>";T+='<ul class="action-a">';if(document.referrer){var W;var V=location.protocol+"//"+location.host+"/";if(document.referrer.substr(document.referrer.length-1)=="/"){if(document.referrer!=V){W="Section"}}else{if((document.referrer.length>V.length)&&(document.referrer.substr(0,V.length)==V)){W="Article"}}if(W){T+='<li class="left"><a href="'+document.referrer+'" class="button-a back"><span>Back to '+W+"</span></a></li>"}}T+='<li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';K.empty().append(T);C()};var e=function(){F("remove");var T='<div class="page-a"><h1>Remove my account</h1><p>You are about to delete your account. When you delete your account will be deleted permanently and any subscriptions you have will be terminated. No refunds will be given on paid-for subscriptions which are terminated early.</p><p class="remove-account"><a href="./" class="button-a"><span>Remove My Account</span></a></p><h2 class="a1">I don’t want to remove my account</h2><p>You may keep your account by clicking the keep my account button below.<p class="keep-account"><a href="./" class="button-a"><span>Keep My Account</span></a></p></div>';K.empty().append(T);C();K.find("p.remove-account a").click(function(U){U.preventDefault();d=true;A();registration.deleteUser(function(V){d=false;if(V.exception){L();B('Server responded with error: "'+V.exception+'". Please try again later.')}else{if(V.userDeleted){L();var W='<div class="page-a"><h1>Account removed</h1><p>Your account has been removed.</p><ul class="action-a"><li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';K.empty().append(W);C()}else{L();B("Could not remove your account. Please try again later.")}}})});K.find("p.keep-account a").click(function(U){U.preventDefault();w()})};var l=function(){$('<nav class="nav-a"><h1>Confirm e-mail address</h1></nav>').prependTo(K.closest("section"));var T=function(){if(!registration.isLoggedIn()){var V='<div class="page-a"><h1>Confirm e-mail address</h1><p>Please sign in to confirm your e-mail address.</p><div class="login-b"><p class="email"><label for="confirmation-login-email">Email address</label> <input type="text" name="email" id="confirmation-login-email" /></p><p class="password"><label for="confirmation-login-password">Password</label> <input type="password" name="password" id="confirmation-login-password" /></p><p class="error"></p></div><ul class="action-a"><li class="right"><a href="/" class="button-a"><span>Sign In</span></a></li></ul></div>';K.empty().append(V);C();K.find(".login-b p label").compactize();K.find(".login-b p.email input, .login-b p.password input").keyup(function(W){if(K.find(".login-b p.error").html()!=""){K.find(".login-b p.error").html("")}if(W.keyCode==13){K.find(".right a").click()}});K.find(".right a").click(function(W){W.preventDefault();A();m=true;registration.login(K.find(".login-b p.email input").val(),K.find(".login-b p.password input").val(),com.inmplc.registration.API.AuthEmail,function(X){L();m=false;if(X.exception){B('Server responded with error: "'+X.exception+'". Please try again later.')}else{if(!X.userValidated){K.find(".login-b p.error").html("We could not log you in. Please check your e-mail address and password.")}else{U()}}})})}else{U()}};var U=function(){var X='<div class="page-a"><h1>Confirm e-mail address</h1><p>We are now confirming your e-mail address.</p></div>';K.empty().append(X);C();A();if($.parameter("reg")=="validate"){var W=$.parameter("prop");var V=$.parameter("code");if(W&&V){registration.validateUserProperty(W,V,function(Y){var aa={};if(Y.exception){B('Server responded with error: "'+Y.exception+'". Please try again later.');aa={h:"Confirm e-mail address failed",p:"An error occurred. Please try again later."}}else{if(Y.userPropertyValidated){aa={h:"Confirm e-mail address",p:'Thank you for confirming your e-mail address. You can update your profile details <a href="'+registration.getOption("accountURL")+'">here</a>.'}}else{if(Y.userPropertyRequiresNoValidation){aa={h:"Confirm e-mail address",p:"Confirmation is not necessary."}}else{if(Y.userPropertyAlreadyValidated){aa={h:"Confirm e-mail address",p:"Your e-mail address was already confirmed."}}else{aa={h:"Confirm e-mail address failed",p:"The confirmation code is invalid. Please try again."}}}}}var Z='<div class="page-a"><h1>'+aa.h+"</h1><p>"+aa.p+'</p><ul class="action-a"><li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';L();K.empty().append(Z);C()})}else{var X='<div class="page-a"><h1>Confirm e-mail address failed</h1><p>The confirmation code is invalid. Please try again.</p><ul class="action-a"><li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';L();K.empty().append(X);C()}}else{callback&&callback.call(b)}};T()};var j=function(){var T=J[b.options.publication];$('<nav class="nav-a"><h1>Unsubscribe From Newsletter</h1></nav>').prependTo(K.closest("section"));var U=function(){var X;$.each(T,function(Z,aa){$.each(aa.products,function(ab,ac){if($.parameter("pr")==ac.name){X=ac.label}})});var W='<div class="page-a"><h1>Unsubscribe from newsletter</h1><p>We are now unsubscribing you from '+(X?(X.substr(0,3)=="The"?X:"the "+X):"the")+" newsletter.</p></div>";K.empty().append(W);C();A();if($.parameter("reg")=="unsubscribe"){var Y=$.parameter("pr");var V=$.parameter("e");if(Y&&V){registration.unsubscribeByProduct(Y,V,function(Z){var ab={};if(Z.exception){ab={h:"Unsubscribe from newsletter failed",p:"An error occurred. Please try again later."}}else{if(Z.success){ab={h:"Unsubscribed from newsletter",p:"You have been unsubscribed from "+(X?(X.substr(0,3)=="The"?X:"the "+X):"the")+" newsletter."}}else{if(Z.noSubscription){ab={h:"Not subscribed to newsletter",p:"You are not subscribed to "+(X?(X.substr(0,3)=="The"?X:"the "+X):"the")+" newsletter."}}else{ab={h:"Unsubscribe from newsletter failed",p:"An error occurred. Please try again later."}}}}var aa='<div class="page-a"><h1>'+ab.h+"</h1><p>"+ab.p+'</p><ul class="action-a"><li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';L();K.empty().append(aa);C()})}else{var W='<div class="page-a"><h1>Unsubscribe from '+(X?X:"")+' newsletter failed</h1><p>The unsubscribe link is invalid. Please try again.</p><ul class="action-a"><li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';L();K.empty().append(W);C()}}};U()};var B=function(T){window.alert(T)};var S=function(){if($("body").find("> .busy-overlay").length==0){$("body").append('<div class="busy-overlay"><div><img src="/img/wait-a.gif" width="40" height="40" /></div><div></div></div>')}};var A=function(){$("body").addClass("busy")};var L=function(){$("body").removeClass("busy")};var C=function(){K.find(".select-a select").vSelect();K.find(".help-a[title], .tooltip-a[title]").powerTip({placement:"n",offset:20,smartPlacement:true}).click(function(T){T.preventDefault()})};var i=function(T){T.each(function(){var U=$(this);var V=h[U.attr("name")]||"";if(U.is("input:checkbox")){if(U.attr("value")==V){U.prop("checked",true)}}else{U.val(V)}})};var n=function(T){T.each(function(){var U=$(this);var V=U.attr("name");if(U.is("input:checkbox")){h[V]=U.is(":checked")?U.val():""}else{h[V]=U.val()}})};var E=function(T){T.closest("p").removeClass("icon success error").find("strong").remove()};var y=function(U,T,V){U.closest("p").addClass("icon "+(T?"error":"success"));if(V){U.closest("p").append("<strong>"+V+"</strong>")}};var s=function(T){return h[T]||""};Q()})};return a})();window.com=window.com||{};window.com.inmplc=window.com.inmplc||{};window.com.inmplc.registration=window.com.inmplc.registration||{};window.com.inmplc.registration.EventHandler=(function(){var b={};var a={};a.spawnEvent=function(d){if(d){if(jQuery.isArray(b[d.type])){for(var c=0;c<b[d.type].length;c++){b[d.type][c](d)}}}};a.addHandler=function(c,d){if(c&&(typeof d==="function")){if(b[c]==undefined){b[c]=[]}b[c].push(d)}};return a})();window.com.inmplc.registration.Event=(function(){var a={};a=function(b,c){if(!c){c={}}this.type=b;this.data=c};return a})();window.com=window.com||{};window.com.facebook=window.com.facebook||{};window.com.facebook.API=(function(){var a={};a=function(){};a.prototype.init=function(c){var b=this;window.onFacebookInit&&window.onFacebookInit(function(){c&&c.call(b)})};a.prototype.getLoginStatus=function(c){var b=this;window.onFacebookInit&&window.onFacebookInit(function(){window.FB.getLoginStatus(function(d){c&&c.call(b,d)})})};a.prototype.login=function(d,c){var b=this;if(window.FB){window.FB.login(function(e){d&&d.call(b,e)},c)}};a.prototype.logout=function(c){var b=this;window.onFacebookInit&&window.onFacebookInit(function(){window.FB.logout(function(d){c&&c.call(b,d)})})};return a}());head.ready("jquery",function(){if($("#fb-root").length==0){$("body").prepend('<div id="fb-root"></div>');(function(c){var b,e="facebook-jssdk",a=c.getElementsByTagName("script")[0];if(c.getElementById(e)){return}b=c.createElement("script");b.id=e;b.async=true;b.src="//connect.facebook.net/en_US/all.js";a.parentNode.insertBefore(b,a)}(document))}});head.ready(function(){$(".registration-header-bar-element").each(function(){var n=$(this);var i=n.attr("data-base-url")||"/";var h=n.closest(".w4");var l=n.closest(".registration-header-bar-element");var a="";if(n.closest("div#persistent").length>0){a="-persistent"}var b=new com.facebook.API();var o=function(){if(h.find(".login").length==0){f()}};var f=function(){var r='<div class="login" id="login'+a+'"><div class="wrap"><div class="left"></div><div class="right"></div></div></div>';h.append(r);d();g();m();var q=h.find(".login > .wrap");var p=q.css("height","auto").height();q.css("height",0);$("head").append("<style>.w4.on > .login > .wrap { height: "+p+"px !important; }</style>")};var d=function(){var r=h.find(".login");var p="<h4>"+registration.getOption("publicationLabel")+' Login</h4><p class="email"><label for="login-email'+a+'">Email address</label> <input type="text" name="email" id="login-email'+a+'" /></p><p class="password"><label for="login-password'+a+'">Password</label> <input type="password" name="password" id="login-password'+a+'" /></p><p class="action"><button type="submit">Sign In</button> <a href="./" class="forgot-password">Forgot password?</a></p><p class="error"></p>';var q=h.find(".login > .wrap > .left");q.empty().append(p);q.find("p label").compactize();q.find("p.email input, p.password input").keyup(function(s){if(q.find("p.error").html()!=""){q.find("p.error").html("")}if(s.keyCode==13){q.find("p.action button").click()}});q.find("p.action button").click(function(s){s.preventDefault();e();registration.login(q.find("p.email input").val(),q.find("p.password input").val(),com.inmplc.registration.API.AuthEmail,function(t){j();if(t.exception){c('Server responded with error: "'+t.exception+'". Please try again later.')}else{if(!t.userValidated){q.find("p.error").html("We could not log you in. Please check your e-mail address and password.")}else{h.removeClass("on")}}})});q.find("p.action a.forgot-password").click(function(s){s.preventDefault();k()})};var g=function(){var p='<h4>Social Login</h4><ul><li class="facebook"><a href="./">Facebook</a></li></ul>';var q=h.find(".login > .wrap > .right");q.empty().append(p);q.find("li.facebook a").click(function(s){s.preventDefault();var r=function(t){e();registration.socialLogin({authtype:com.inmplc.registration.API.AuthFacebook,authkey:t.authResponse.userID,token:t.authResponse.accessToken},function(u){if(u.exception){j();c('Server responded with error: "'+u.exception+'". Please try again later.')}else{if(!u.userValidated){registration.register([{authenticationType:com.inmplc.registration.API.AuthFacebook,authenticationKey:t.authResponse.userID}],{token:t.authResponse.accessToken},function(v){j();if(v.exception){c('Server responded with error: "'+v.exception+'". Please try again later.')}else{if(v.userRegistered){h.removeClass("on")}}})}else{j();h.removeClass("on")}}})};b.getLoginStatus(function(t){if(t.status!="connected"){b.login(function(u){setTimeout(function(){if(u.authResponse){r(u)}},1000)},{scope:"email"})}else{r(t)}})})};var k=function(){var r=h.find(".login");var p="<h4>"+registration.getOption("publicationLabel")+' Login - Forgot Password</h4><p class="email"><label for="forgot-password-email'+a+'">Email address</label> <input type="text" name="email" id="forgot-password-email'+a+'" /></p><p class="action"><button type="submit">Continue</button></p><p class="error"></p>';var q=h.find(".login > .wrap > .left");q.empty().append(p);q.find("p label").compactize();q.find("p.email input").keyup(function(){if(q.find("p.error").html()!=""){q.find("p.error").html("")}});q.find("p.action button").click(function(s){s.preventDefault();e();registration.resetPassword(q.find("p.email input").val(),function(t){j();if(t.exception){c('Server responded with error: "'+t.exception+'". Please try again later.')}else{if(t.emailAddressMissing){q.find("p.error").html("E-mail address missing.")}else{if(t.alreadyLoggedIn){q.find("p.error").html("You are already logged in.")}else{if(t.userNotFound){q.find("p.error").html("No user is registered with the given e-mail address. Please check your e-mail address.")}else{if(t.passwordReset){var u="<h4>"+registration.getOption("publicationLabel")+' Login - Forgot Password</h4><p class="message">Your password has been reset. We have sent you an e-mail containing the new password.<br/>On your profile page you are able to change your password.</p>';q.empty().append(u)}else{q.find("p.error").html("Password could not be reset. Please try again later.")}}}}}})})};var c=function(p){window.alert(p)};var m=function(){if(h.find(".login > .busy-overlay").length==0){h.find(".login").append('<div class="busy-overlay"><div><img src="'+i+'img/wait-a.gif" width="40" height="40" /></div><div></div></div>')}};var e=function(){h.find(".login").addClass("busy")};var j=function(){h.find(".login").removeClass("busy")};o();registration.onLoggedIn(function(){if(n.hasClass("logged-in-account")){n.empty().append('<li><a href="'+registration.getOption("accountURL")+'">My Account</a></li>');if((n.closest("header#top").length>0)&&(location.pathname=="/")&&($.parameter("reg")=="unsubscribe")){window.location.href=registration.getOption("accountURL")+location.search}}else{if(n.hasClass("logged-in-logout")){n.empty().append('<li class="logout"><a href="#logout">Logout</a></li>');n.find("li.logout a").click(function(q){q.preventDefault();var p=registration.getUser();if(p&&p.facebookUserId){b.logout()}registration.logout(function(){})})}else{if(n.hasClass("logged-in-newsletterSignup")){n.empty().append('<li><a href="'+registration.getOption("newsletterSignupURL")+'">Newsletter</a></li>')}else{n.empty()}}}if(h.hasClass("on")){h.removeClass("on")}},true);registration.onLoggedOut(function(){if(n.hasClass("logged-out-register")){n.empty().append('<li><a href="'+registration.getOption("registerURL")+'">Register</a></li>');if((n.closest("header#top").length>0)&&($.parameter("reg")=="register")){window.location.href=registration.getOption("registerURL")}if((n.closest("header#top").length>0)&&(location.pathname=="/")&&($.parameter("reg")=="unsubscribe")){window.location.href=registration.getOption("accountURL")+location.search}}else{if(n.hasClass("logged-out-signin")){n.empty().append('<li class="signin"><a href="#signin">Sign In With</a></li>');n.find("li.signin a").click(function(p){p.preventDefault();b.init();if(!h.hasClass("on")){d()}h.toggleClass("on");trackVirtualPageViewLoginPushDown(domain=l.attr("data-domain"));if(h.is(".on")){comscoreVirtualPageView&&comscoreVirtualPageView("login-pushdown")}});if((n.closest("header#top").length>0)&&($.parameter("reg")=="login")){setTimeout(function(){n.find("li.signin a").click()},1000)}}else{if(n.hasClass("logged-out-newsletterSignup")){n.empty().append('<li><a href="'+registration.getOption("newsletterSignupURL")+'">Newsletter</a></li>')}else{n.empty()}}}},true)})});window.com=window.com||{};window.com.inmplc=window.com.inmplc||{};window.com.inmplc.registration=window.com.inmplc.registration||{};window.com.inmplc.registration.Location=(function(){var a={};a.Countries=["Afghanistan","Aland Islands","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antarctica","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia, Plurinational State of","Bonaire, Sint Eustatius and Saba","Bosnia and Herzegovina","Botswana","Bouvet Island","Brazil","British Indian Ocean Territory","Brunei Darussalam","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo","Congo, The Democratic Republic of the","Cook Islands","Costa Rica","Cote d'Ivoire","Croatia","Cuba","Curacao","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands (Malvinas)","Faroe Islands","Fiji","Finland","France","French Guiana","French Polynesia","French Southern Territories","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe","Guam","Guatemala","Guernsey","Guinea","Guinea-Bissau","Guyana","Haiti","Heard Island and McDonald Islands","Holy See (Vatican City State)","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran, Islamic Republic of","Iraq","Ireland","Isle of Man","Israel","Italy","Jamaica","Japan","Jersey","Jordan","Kazakhstan","Kenya","Kiribati","Korea, Democratic People's Republic of","Korea, Republic of","Kuwait","Kyrgyzstan","Lao People's Democratic Republic","Latvia","Lebanon","Lesotho","Liberia","Libyan Arab Jamahiriya","Liechtenstein","Lithuania","Luxembourg","Macao","Macedonia, The Former Yugoslav Republic of","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique","Mauritania","Mauritius","Mayotte","Mexico","Micronesia, Federated States of","Moldova, Republic of","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Caledonia","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","Northern Ireland","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Palestinian Territory, Occupied","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn","Poland","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russian Federation","Rwanda","Saint Barthelemy","Saint Helena, Ascension and Tristan Da Cunha","Saint Kitts and Nevis","Saint Lucia","Saint Martin (French Part)","Saint Pierre and Miquelon","Saint Vincent and The Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Sint Maarten (Dutch Part)","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and The South Sandwich Islands","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard And Jan Mayen","Swaziland","Sweden","Switzerland","Syrian Arab Republic","Taiwan, Province of China","Tajikistan","Tanzania, United Republic of","Thailand","Timor-Leste","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","United States Minor Outlying Islands","Uruguay","Uzbekistan","Vanuatu","Venezuela, Bolivarian Republic of","Viet Nam","Virgin Islands, British","Virgin Islands, U.S.","Wallis and Futuna","Western Sahara","Yemen","Zambia","Zimbabwe"];a.Counties={Ireland:["Antrim","Armagh","Carlow","Cavan","Clare","Cork","Derry","Donegal","Down","Dublin","Fermanagh","Galway","Kerry","Kildare","Kilkenny","Laois","Leitrim","Limerick","Longford","Louth","Mayo","Meath","Monaghan","Offaly","Roscommon","Sligo","Tipperary","Tyrone","Waterford","Westmeath","Wexford","Wicklow"]};a.getCountries=function(c){var b=[];if(c){$.each(c,function(d,e){b.push(e)})}$.each(this.Countries,function(d,e){if(!c||($.inArray(e,c)==-1)){b.push(e)}});return b};a.getCounties=function(b){return this.Counties[b]};return a})();window.com=window.com||{};window.com.inmplc=window.com.inmplc||{};window.com.inmplc.registration=window.com.inmplc.registration||{};window.com.inmplc.registration.NewsletterSignup=(function(){var a={};a=function(b){this.options={target:".registration-newsletter-signup"};this.facebookApi=new com.facebook.API();$.extend(this.options,b)};a.prototype.init=function(){var b=this;$(b.options.target).each(function(){var y=$(this);var k={};var c=false;var i={independent:{personalDetailInfo:"What is an Independent profile?",personalDetailInfoTooltip:"Once registered an Independent profile will enable you to access all of our current services, including newsletters and any future service we may offer, by simply loggin in rather than filling out forms.",},herald:{personalDetailInfo:"What is a Herald profile?",personalDetailInfoTooltip:"Once registered a Herald profile will enable you to access all of our current services, including newsletters and any future service we may offer, by simply loggin in rather than filling out forms.",},belfasttelegraph:{personalDetailInfo:"What is a Belfast Telegraph profile?",personalDetailInfoTooltip:"Once registered a Belfast Telegraph profile will enable you to access all of our current services, including newsletters and any future service we may offer, by simply loggin in rather than filling out forms.",}};var A={independent:[{name:"newsletters",label:"Newsletters",products:[{name:"daily_newsletter",label:"The Daily",description:"Sign up for the Independent.ie daily news roundup for free!",thumbnail:"/img/daily.png",preview:"View newsletter",previewLink:b.options.daily_newsletter},{name:"thelot_newsletter",label:"The Lot",description:"Exclusive competitions, lifestyle, fitness, fashion & entertainment via email. Sign up FOR FREE!",thumbnail:"/img/thelot.png",preview:"View newsletter",previewLink:b.options.thelot_newsletter},{name:"herald_newsletter",label:"Herald",description:"Get free news emails from herald.ie every day.",thumbnail:"/img/herald.png",preview:"View newsletter",previewLink:b.options.herald_newsletter}]}],herald:[{name:"herald_newsletters",label:"Newsletters",products:[{name:"daily_newsletter",label:"The Daily",description:"Sign up for the Independent.ie daily news roundup for free!",thumbnail:"/img/daily.png",preview:"View newsletter",previewLink:b.options.daily_newsletter},{name:"thelot_newsletter",label:"The Lot",description:"Exclusive competitions, lifestyle, fitness, fashion & entertainment via email. Sign up FOR FREE!",thumbnail:"/img/thelot.png",preview:"View newsletter",previewLink:b.options.thelot_newsletter},{name:"herald_newsletter",label:"Herald",description:"Get free news emails from herald.ie every day.",thumbnail:"/img/herald.png",preview:"View newsletter",previewLink:b.options.herald_newsletter}]}],belfasttelegraph:[{name:"bt_alerts",label:"Belfast Telegraph Alerts",products:[{name:"bt_dailynews",label:"Daily News Headlines",description:"Daily news headlines from Belfast Telegraph.",thumbnail:"/img/daily-newsletter.png",preview:"View newsletter",previewLink:b.options.bt_dailynews},{name:"bt_weeklybusiness",label:"Weekly Business Digest",description:"Weekly business digest from Belfast Telegraph.",thumbnail:"/img/business-newsletter.png",preview:"View newsletter",previewLink:b.options.bt_weeklybusiness}]}]};var r=function(){if(registration.isLoggedIn()){location.href=registration.getOption("accountURL")+"#newsletters"}else{s();l();m();n();t()}};var s=function(){registration.onLoggedIn(function(){if(!c){location.href=registration.getOption("accountURL")+"#newsletters"}})};var l=function(){$('<nav class="nav-a"><h1>Newsletters</h1></nav>').prependTo(y.closest("section"));y.addClass("wrap-a home-a")};var n=function(){var B='<h1>Login</h1><div class="login-a"><div class="basic"></div><div class="social"></div></div>';y.append(B);u();q()};var u=function(){var D=y.find(".login-a");var B="<h3>"+registration.getOption("publicationLabel")+' Login</h3><p class="email"><label for="login-a-email">Email address</label> <input type="text" name="email" id="login-a-email" /></p><p class="password"><label for="login-a-password">Password</label> <input type="password" name="password" id="login-a-password" /></p><p class="action"><button type="submit" class="button-a">Sign In</button> <a href="./" class="forgot-password">Forgot password?</a></p><p class="error"></p>';var C=y.find(".login-a > .basic");C.empty().append(B);C.find("p label").compactize();C.find("p.email input, p.password input").keyup(function(E){if(C.find("p.error").html()!=""){C.find("p.error").html("")}if(E.keyCode==13){C.find("p.action button").click()}});C.find("p.action button").click(function(E){E.preventDefault();x();registration.login(C.find("p.email input").val(),C.find("p.password input").val(),com.inmplc.registration.API.AuthEmail,function(F){j();if(F.exception){f('Server responded with error: "'+F.exception+'". Please try again later.')}else{if(!F.userValidated){C.find("p.error").html("We could not log you in. Please check your e-mail address and password.")}}})});C.find("p.action a.forgot-password").click(function(E){E.preventDefault();v()})};var q=function(){var B='<h3>Social Login</h3><ul><li class="facebook"><a href="./">Facebook</a></li></ul>';var C=y.find(".login-a > .social");C.empty().append(B);C.find("li.facebook a").click(function(E){E.preventDefault();var D=function(F){x();registration.socialLogin({authtype:com.inmplc.registration.API.AuthFacebook,authkey:F.authResponse.userID,token:F.authResponse.accessToken},function(G){if(G.exception){j();f('Server responded with error: "'+G.exception+'". Please try again later.')}else{if(!G.userValidated){registration.register([{authenticationType:com.inmplc.registration.API.AuthFacebook,authenticationKey:F.authResponse.userID}],{token:F.authResponse.accessToken},function(H){j();if(H.exception){f('Server responded with error: "'+H.exception+'". Please try again later.')}})}else{j()}}})};b.facebookApi.getLoginStatus(function(F){if(F.status!="connected"){b.facebookApi.login(function(G){setTimeout(function(){if(G.authResponse){D(G)}},1000)},{scope:"email"})}else{D(F)}})})};var v=function(){var D=y.find(".login-a");var B="<h3>"+registration.getOption("publicationLabel")+' Login - Forgot Password</h3><p class="email"><label for="login-a-forgot-password-email">Email address</label> <input type="text" name="email" id="login-a-forgot-password-email" /></p><p class="action"><button type="submit">Continue</button></p><p class="error"></p>';var C=y.find(".login-a > .basic");C.empty().append(B);C.find("p label").compactize();C.find("p.email input").keyup(function(){if(C.find("p.error").html()!=""){C.find("p.error").html("")}});C.find("p.action button").click(function(E){E.preventDefault();x();registration.resetPassword(C.find("p.email input").val(),function(F){j();if(F.exception){f('Server responded with error: "'+F.exception+'". Please try again later.')}else{if(F.emailAddressMissing){C.find("p.error").html("E-mail address missing.")}else{if(F.alreadyLoggedIn){C.find("p.error").html("You are already logged in.")}else{if(F.userNotFound){C.find("p.error").html("No user is registered with the given e-mail address. Please check your e-mail address.")}else{if(F.passwordReset){var G="<h3>"+registration.getOption("publicationLabel")+' Login - Forgot Password</h3><p class="message">Your password has been reset. We have sent you an e-mail containing the new password.<br/>On your profile page you are able to change your password.</p>';C.empty().append(G)}else{C.find("p.error").html("Password could not be reset. Please try again later.")}}}}}})})};var t=function(){var C=i[b.options.publication];var B=A[b.options.publication];var D='<h2 class="a1">New User</h2><p>Select the newsletters you would like to subscribe to</p>';$.each(B,function(G,H){D+='<ul class="list-b">';$.each(H.products,function(I,J){D+='<li><input type="checkbox" name="prod_'+J.name+'" id="signup-'+J.name+'" value="signup" /> <label for="signup-'+J.name+'"><img src="'+J.thumbnail+'" width="175" height="175" alt="'+J.label+'" /> <br /><span><strong>'+J.label+"</strong>";if(J.preview&&J.previewLink){D+=' <br /><a href="'+J.previewLink+'" target="_blank">'+J.preview+"</a>"}D+="</span><br />";if(J.description){D+=J.description}D+="</label></li>"});D+="</ul>"});D+='<div class="fields-a"><div class="fieldset"><h3>Create Your Account</h3><p><label for="signup-gender" data-label="Gender">Gender <em>*</em></label> <span class="select-a small"><select id="signup-gender" name="prop_gender"><option value=""></option><option value="male">Male</option><option value="female">Female</option></select></span></p><p><label for="signup-email" data-label="Email Address">Email Address <em>*</em></label> <input type="text" id="signup-email" name="email" value="'+o("email")+'" maxlength="254" /></p><p><label for="signup-password" data-label="Password">Password <em>*</em></label> <input type="password" id="signup-password" name="password" value="'+o("password")+'" /></p><p><label for="signup-confirm" data-label="Confirm Password">Confirm Password <em>*</em></label> <input type="password" id="signup-confirm" name="confirm" value="'+o("confirm")+'" maxlength="15" /></p><p class="tick"><input type="checkbox" name="terms" id="signup-terms" value="agree" /> <label for="signup-terms">I have read and agree to the <a href="'+b.options.termsConditionsUrl+'" target="_blank">Terms &amp; Conditions</a> and <a href="'+b.options.privacyPolicyUrl+'" target="_blank">Privacy &amp; Cookie Policy</a></label></p></div><p class="action"><button type="submit" class="button-a">Register</button></p></div>';y.append(D);g(y.find(".fieldset input, .fieldset select"));h();var F=function(H,I,J){w(H);if(H.val()!=""){if(I.validate&&I.validate.regex&&!I.validate.regex.test(H.val())){z(H,true,I.validate.message||"")}else{if(I.match&&I.match.field&&(H.val()!=I.match.field.val())){z(H,true,I.match.message||"")}else{if(I.checked&&!H.is(":checked")){z(H,true,I.checked.message||"")}else{if(I.auth&&(I.auth.type=="username")){if(registration.isLoggedIn()){var G={};G[com.inmplc.registration.API.AuthUsername]=H.val();registration.setAuthentications(G,true,function(K){if(K.exception){z(H,true,"Cannot check username. Please try again later.")}else{if(!K.success){z(H,true,I.auth.message||"")}else{z(H,false)}}J&&J.call(H)})}else{registration.register([{authenticationType:com.inmplc.registration.API.AuthUsername,authenticationKey:H.val()}],{password:"abc456d8"},true,function(K){if(K.exception){z(H,true,"Cannot check username. Please try again later.")}else{if(K.existingAuthentications){z(H,true,I.auth.message||"")}else{z(H,false)}}J&&J.call(H)})}}else{if(I.auth&&(I.auth.type=="email")){if(registration.isLoggedIn()){var G={};G[com.inmplc.registration.API.AuthEmail]=H.val();registration.setAuthentications(G,true,function(K){if(K.exception){z(H,true,"Cannot check email. Please try again later.")}else{if(!K.success){z(H,true,I.auth.message||"")}else{z(H,false)}}J&&J.call(H)})}else{registration.register([{authenticationType:com.inmplc.registration.API.AuthEmail,authenticationKey:H.val()}],{password:"abc456d8"},true,function(K){if(K.exception){z(H,true,"Cannot check email. Please try again later.")}else{if(K.existingAuthentications){z(H,true,I.auth.message||"")}else{z(H,false)}}J&&J.call(H)})}}else{if(!I.noCheckmark){z(H,false)}}}}}}}else{if(I.checkEmpty){z(H,true,I.checkEmpty.message||(H.closest("p").find("label").attr("data-label")+" is required."));I.auth&&J&&J.call(H)}}!I.auth&&J&&J.call(H)};var E=function(H,G,I){if(H.is("#signup-email")){F(H,{validate:{regex:/^([0-9a-zA-Z]([-.\w]*[\w])?@([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})$/,message:"Invalid email address."},auth:{type:"email",message:"Email address already exists."},checkEmpty:G&&{}},I)}else{if(H.is("#signup-password")){F(H,{validate:{regex:/^(?=.*[\d@#$%^&+=!\-])[a-zA-Z\d@#$%^&+=!\-]{7,}$/,message:"Password must be minimum 7 characters with at least one number or special character (@, #, $, %, ^, &amp;, +, =, ! or -)."},checkEmpty:G&&{}},I)}else{if(H.is("#signup-confirm")){F(H,{match:{field:y.find("#signup-password"),message:"Passwords do not match"},checkEmpty:G&&{message:"You need to confirm your password."}},I)}else{if(H.is("#signup-gender")){F(H,{checkEmpty:G&&{}},I)}else{if(H.is("#signup-terms")){F(H,{checked:G&&{message:"You must agree to the Terms & Conditions."},noCheckmark:{}},I)}}}}}};y.find(".fields-a .fieldset p input, .fields-a .fieldset p select").livevalidate(function(){E($(this),false)},function(){w($(this))});y.find(".fields-a p.action button").click(function(I){I.preventDefault();x();var H=$(this);var G=[];y.find(".fieldset p input, .fieldset p select").each(function(){G.push($(this).attr("name"))});y.find(".fieldset p input, .fieldset p select").each(function(){E($(this),true,function(){var K=$(this);var L=K.attr("name");($.inArray(L,G)>=0)&&G.splice($.inArray(L,G),1);if(G.length==0){var J=(y.find(".fieldset p.error").length>0);if(!J){p(y.find(".list-b input, .fieldset input, .fieldset select"));d()}else{j()}}})})})};var d=function(){var C=[];C.push({authenticationType:com.inmplc.registration.API.AuthEmail,authenticationKey:k.email});var B=k.password;c=true;registration.register(C,{password:B},function(D){c=false;if(D.exception){j();f('Server responded with error: "'+D.exception+'". Please try again later.')}else{if(D.userRegistered){var E={};var F=[];$.each(k,function(J,H){if(J.substr(0,5)=="prop_"){var I=J.substr(5).toLowerCase();if(H){E[I]=H}}else{if(J.substr(0,5)=="prod_"){var G=J.substr(5).toLowerCase();if(H){F.push(G)}}}});registration.setUserProperties(E,function(G){if(G.exception){j();f('Server responded with error: "'+G.exception+'". Please try again later.')}else{if(G.success){if(F.length>0){registration.subscribe(F,function(H){j();if(H.exception){f('Server responded with error: "'+H.exception+'". Please try again later.')}else{if(H.success){e()}else{f("Could not subscribe to newsletters. Please try again later.")}}})}else{j();e()}}else{j();f("Could not set user properties. Please try again later.")}}})}else{j();f("Could not register new user. Please try again later.")}}})};var e=function(){var C={};$.each(k,function(H,G){if((H.substr(0,5)=="prod_")&&G){C[H]=G}});var D='<div class="page-a"><h1>Thank you for registering</h1><p>We have sent you an email to confirm your email address. If you have registered for newsletters you will start receiving them once you\'ve confirmed your email address.</p><p><a href="'+b.options.privacyPolicyUrl+'">Privacy and Cookie Policy</a></p>';if(!$.isEmptyObject(C)){var B=A[b.options.publication];$.each(B,function(G,I){var H=false;$.each(I.products,function(J,K){if(C["prod_"+K.name]){H=true}});if(H){D+="<h2>You subscribed to the following "+I.label+'</h2><ul class="list-a">';$.each(I.products,function(J,K){if(C["prod_"+K.name]){D+='<li><img src="'+K.thumbnail+'" width="120" height="120" alt="'+K.label+'" />'+K.label+"</li>"}});D+="</ul>"}})}if(window.stButtons){D+='<h2>Tell your friends to join the conversation</h2><p><div class="w49 clean"><div class="share buttons"><span class="st_facebook_hcount" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" displayText="Facebook Recommend"></span><span class="st_twitter_hcount" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" st_via="" displayText="Tweet"></span><span class="st_googleplus_hcount" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" displayText="Google +1"></span><span class="st_sharethis" st_url="'+registration.getOption("registerURL")+'" st_title="'+registration.getOption("publicationLabel")+' Registration" displayText="Share"></span></div></div></p>'}D+='<ul class="action-a">';if(document.referrer){var F;var E=location.protocol+"//"+location.host+"/";if(document.referrer.substr(document.referrer.length-1)=="/"){if(document.referrer!=E){F="Section"}}else{if((document.referrer.length>E.length)&&(document.referrer.substr(0,E.length)==E)){F="Article"}}if(F){D+='<li class="left"><a href="'+document.referrer+'" class="button-a back"><span>Back to '+F+"</span></a></li>"}}D+='<li class="right"><a href="/" class="button-a"><span>Homepage</span></a></li></ul></div>';y.empty().append(D);window.stButtons&&window.stButtons.locateElements();h()};var f=function(B){window.alert(B)};var m=function(){if($("body").find("> .busy-overlay").length==0){$("body").append('<div class="busy-overlay"><div><img src="/img/wait-a.gif" width="40" height="40" /></div><div></div></div>')}};var x=function(){$("body").addClass("busy")};var j=function(){$("body").removeClass("busy")};var h=function(){y.find(".select-a select").vSelect()};var g=function(B){B.each(function(){var C=$(this);var D=k[C.attr("name")]||"";if(C.is("input:checkbox")){if(C.attr("value")==D){C.prop("checked",true)}}else{C.val(D)}})};var p=function(B){B.each(function(){var C=$(this);var D=C.attr("name");if(C.is("input:checkbox")){k[D]=C.is(":checked")?C.val():""}else{k[D]=C.val()}})};var w=function(B){B.closest("p").removeClass("icon success error").find("strong").remove()};var z=function(C,B,D){C.closest("p").addClass("icon "+(B?"error":"success"));if(D){C.closest("p").append("<strong>"+D+"</strong>")}};var o=function(B){return k[B]||""};r()})};return a})();window.com=window.com||{};window.com.inmplc=window.com.inmplc||{};window.com.inmplc.registration=window.com.inmplc.registration||{};window.com.inmplc.registration.API=(function(){var a=com.inmplc.registration.Event;var c=com.inmplc.registration.EventHandler;var b={};b=function(d){this.options={cookieName:"regsso"};this.facebookApi=new com.facebook.API();$.extend(this.options,d);if(!this.options.server){console&&console.log&&console.log('Required option "server" not set.')}if(!this.options.key){console&&console.log&&console.log('Required option "key" not set.')}$.cookie.json=true;var e=$.cookie(this.options.cookieName);if(e&&e.user){this.sessionUserId=e.user.id}this.apiCall=function(n,i,m){var l=this;var j={success:function(p){$.cookie.json=true;if(!p.error){if(p.sessionValid&&p.ssoCookieValue){var o=JSON.parse(p.ssoCookieValue);$.cookie(l.options.cookieName,o,{path:"/",domain:l.options.cookieDomain})}else{if(p.sessionValid!=undefined){if(l.options.cookieDomain){$.removeCookie(l.options.cookieName,{path:"/",domain:l.options.cookieDomain})}$.removeCookie(l.options.cookieName,{path:"/"})}}}if(p.userNotLoggedIn){$.removeCookie(l.options.cookieName,{path:"/",domain:l.options.cookieDomain})}var q=$.cookie(l.options.cookieName);if(q&&q.user){if(q.user.id!=l.sessionUserId){c.spawnEvent(new a("loggedIn",{user:l.getUser()}))}l.sessionUserId=q.user.id}else{if(l.sessionUserId){c.spawnEvent(new a("loggedOut"))}l.sessionUserId=undefined}if(p.error){m&&m.call(l,{exception:p.message})}else{m&&m.call(l,p.content)}},complete:function(o,p){},error:function(p,r,q){var o=r+": "+q;if(p){if(p.status){o=p.status+" "+p.statusText}else{if(p.status==0){o="Connection refused"}}}m&&m.call(l,{exception:o})},dataType:"jsonp",cache:true,jsonp:"callback",url:this.options.server+"/"+n};var g={apikey:this.options.key,format:"jsonp"};for(var f in i){g[f]=i[f]}if(this.options.secret){j.jsonpCallback="jsonp"+new Date().getTime();var k=j.jsonpCallback;for(var h in g){k+=":"+g[h]}k+=":"+this.options.secret;g.signature=$.sha1(k)}j.data=g;$.ajax(j)}};b.AuthUsername="username";b.AuthEmail="email_address";b.AuthFacebook="facebook";b.prototype.getOptions=function(){return this.options};b.prototype.getOption=function(d){return this.options[d]};b.prototype.setOptions=function(d){$.extend(this.options,d)};b.prototype.getUser=function(){$.cookie.json=true;var d=$.cookie(this.options.cookieName);return(d&&d.user)||undefined};b.prototype.isLoggedIn=function(){return !!this.getUser()};b.prototype.login=function(e,f,h,i){var d=this;var g={authkey:e,password:$.sha1(f)};if(h){g.authtype=h}this.apiCall("user/login",g,function(j){if(j.invalidHashMethod){if(j.useHashMethod=="md5"){g.password=$.md5(f);g.hashmethod="MD5"}else{g.password=$.sha1(f)}this.apiCall("user/login",g,function(k){i&&i.call(d,k)})}else{i&&i.call(d,j)}})};b.prototype.socialLogin=function(e,f){var d=this;d.apiCall("user/login",e,function(g){f&&f.call(d,g)})};b.prototype.logout=function(e){var d=this;this.apiCall("session/logout",{},function(f){e&&e.call(d)})};b.prototype.resetPassword=function(e,f){var d=this;this.apiCall("user/resetpassword",{email:e},function(g){f&&f.call(d,g)})};b.prototype.register=function(g,e,h,i){var d=this;if(typeof e==="function"){i=e;e=undefined}if(typeof h==="function"){i=h;h=undefined}var f={authentications:JSON.stringify(g),};if(e&&e.password){f.password=$.sha1(e.password)}if(e&&e.token){f.token=e.token}if(h){f.checkonly="true"}this.apiCall("user/register",f,function(j){i&&i.call(d,j)})};b.prototype.deleteUser=function(e){var d=this;this.apiCall("user/delete",{},function(f){e&&e.call(d,f)})};b.prototype.getAuthentications=function(e){var d=this;this.apiCall("user/getauthentications",{},function(f){e&&e.call(d,f)})};b.prototype.setAuthentications=function(f,g,h){var d=this;var e={authentications:JSON.stringify(f)};if(typeof g==="function"){h=g;g=undefined}if(g){e.checkonly="true"}this.apiCall("user/setauthentications",e,function(i){h&&h.call(d,i)})};b.prototype.getUserProperties=function(e){var d=this;this.apiCall("user/getuserproperties",{},function(f){e&&e.call(d,f)})};b.prototype.setPassword=function(e,g){var d=this;var f={password:$.sha1(e)};this.apiCall("user/setpassword",f,function(h){g&&g.call(d,h)})};b.prototype.setUserProperties=function(f,g,h){var d=this;if(typeof g==="function"){h=g;g=undefined}var e={userproperties:JSON.stringify(f)};if(g){e.checkonly="true"}this.apiCall("user/setuserproperties",e,function(i){h&&h.call(d,i)})};b.prototype.validateUserProperty=function(g,e,h){var d=this;if(typeof e==="function"){h=e;e=undefined}var f={userproperty:g};if(e){f.validationcode=e}else{f.resend=true}this.apiCall("user/validateuserproperty",f,function(i){h&&h.call(d,i)})};b.prototype.getSubscriptions=function(g,e,h){var d=this;if(typeof g==="function"){h=g;g=undefined}if(typeof e==="function"){h=e;e=undefined}var f={};if(g){f.includeExpired="true"}if(e){f.includeRenewed="true"}this.apiCall("subscription/getsubscriptions",f,function(i){h&&h.call(d,i)})};b.prototype.subscribe=function(i,j,k){var d=this;if(typeof j==="function"){k=j;j=undefined}var g={products:i.join(",")};try{var f=location.href;if(f.indexOf("?")>-1){f=f.substr(0,f.indexOf("?"))}g.contenturl=f}catch(h){}if(j){g.checkonly="true"}this.apiCall("product/subscribe",g,function(e){if(e.success){c.spawnEvent(new a("subscribed"),{subscriptions:e.subscriptions})}k&&k.call(d,e)})};b.prototype.unsubscribe=function(h,f,g){var d=this;if(typeof f==="function"){g=f;f=undefined}var e={subscriptions:h.join(",")};if(f){e.checkonly="true"}this.apiCall("subscription/unsubscribe",e,function(i){if(i.success){c.spawnEvent(new a("unsubscribed"))}g&&g.call(d,i)})};b.prototype.unsubscribeByProduct=function(g,e,h,i){var d=this;if(typeof h==="function"){i=h;h=undefined}var f={product:g,email:e};if(h){f.checkonly="true"}this.apiCall("subscription/unsubscribebyproduct",f,function(j){i&&i.call(d,j)})};b.prototype.bind=function(d,e){if(d&&(typeof e==="function")){c.addHandler(d,e)}};jQuery.each(("loggedIn loggedOut").split(" "),function(f,e){var d="on"+e.substr(0,1).toUpperCase()+e.substr(1);b.prototype[d]=function(g,h){this.bind(e,g);if(h){if(this.isLoggedIn()){if(e=="loggedIn"){g(new a("loggedIn",{user:this.getUser()}))}}else{if(e=="loggedOut"){g(new a("loggedOut"))}}}}});return b})();